# 이벤트 큐
## 이벤트 큐의 용도
메시지나 이벤트를 보내는 시점과 처리하는 시점을 디커플링한다.

## 패턴
* 요청이나 알림을 큐에 저장한다. 저장한 측 코드에서는 이들의 반환 결과를 기다리지 않고 비동기적으로 실행하도록 한다.
* 요청은 직접 혹은 다른 곳으로 보내어 적절한 때에 처리한다.

## 써야 하는 상황
* 메시지를 보내는 시점과 받는 시점을 분리하고 싶다.

## 주의 사항
* 중앙 이벤트 큐는 전역 변수와 같다.
* 월드 상태가 이벤트가 만들어질 당시 상태와 다를 수 있다.
* 피드백 루프에 빠질 수 있다.

## 디자인 결정
* 큐에 넣을 내용
    * 이벤트 - 발생한 사건
        * 복수의 리스너를 지원해야 할 수 있다.
        * 큐의 범위가 더 넓은 편이다.(더 전역적이게 된다.)
    * 메시지 - 앞으로의 요청
        * 리스너가 하나다.

* 큐의 리스너
    * 싱글캐스트 큐
        * 큐는 밖에서 보이지 않는 내부 구현이 된다.
        * 큐가 더 캡슐화된다.
        * 리스너 경쟁이 없다.
    * 브로드캐스트 큐
        * 이벤트가 무시될 수 있다.
        * 이벤트 필터링이 필요할 수 있다.
    * 작업 큐 - 복수의 리스너, 데이터는 한곳으로 감
        * 다중 스레드에 작업을 나눠줘야 할 때 사용한다.
        * 작업을 분배ㅐ야 한다.

* 데이터를 넣는 측
    * 단일
        * 어디에서 이벤트가 오는지 안다.
        * 리스너가 여러 개다.
    * 복수
        * 이벤트 순환을 주의해야 한다.
        * 이벤트를 보낸 객체에 대한 정보를 이벤트에 추가해야 할 수 있다.

* 큐의 데이터의 생명주기 관리
    * 메시지와 함께 소유권 전달
    * 소유권 공유 - 아무도 참조하지 않을 때 알아서 해제
    * 큐가 소유권을 가짐